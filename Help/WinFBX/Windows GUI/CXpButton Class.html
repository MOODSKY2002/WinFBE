<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta http-equiv='MSThemeCompatible' content='Yes'>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CXpButton Class</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">@font-face {font-family: octicons-link;src: url(data:font/woff;charset=utf-8;base64,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) format('woff');}body {-webkit-text-size-adjust: 100%;text-size-adjust: 100%;color: #333;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.6;word-wrap: break-word;max-width: 99%;box-sizing: border-box;padding: 20px 5px 8rem 5px; margin-left: auto;margin-right: auto;}body a {background-color: transparent;}body a:active,body a:hover {outline: 0;}body strong {font-weight: bold;}body h1 {font-size: 2em;margin: 0.67em 0;}body img {border: 0;}body hr {box-sizing: content-box;height: 0;}body pre {overflow: auto;}body code,body kbd,body pre {font-family: monospace, monospace;font-size: 1em;}body input {color: inherit;font: inherit;margin: 0;}body html input[disabled] {cursor: default;}body input {line-height: normal;}body input[type="checkbox"] {box-sizing: border-box;padding: 0;}body table {border-collapse: collapse;border-spacing: 0;}body td,body th {padding: 0;}body * {box-sizing: border-box;}body input {font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body a {color: #4078c0;text-decoration: none;}body a:hover,body a:active {text-decoration: underline;}body hr {height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd;}body hr:before {display: table;content: "";}body hr:after {display: table;clear: both;content: "";}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 15px;margin-bottom: 15px;line-height: 1.1;}body h1 {font-size: 30px;}body h2 {font-size: 21px;}body h3 {font-size: 16px;}body h4 {font-size: 14px;}body h5 {font-size: 12px;}body h6 {font-size: 11px;}body blockquote {margin: 0;}body ul,body ol {padding: 0;margin-top: 0;margin-bottom: 0;}body ol ol,body ul ol {list-style-type: lower-roman;}body ul ul ol,body ul ol ol,body ol ul ol,body ol ol ol {list-style-type: lower-alpha;}body dd {margin-left: 0;}body code {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px;}body pre {margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;}body .select::-ms-expand {opacity: 0;}body .octicon {font: normal normal normal 16px/1 octicons-link;display: inline-block;text-decoration: none;text-rendering: auto;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}body .octicon-link:before {content: '\f05c';}body:before {display: table;content: "";}body:after {display: table;clear: both;content: "";}body>*:first-child {margin-top: 0 !important;}body>*:last-child {margin-bottom: 0 !important;}body a:not([href]) {color: inherit;text-decoration: none;}body .anchor {display: inline-block;padding-right: 2px;margin-left: -18px;}body .anchor:focus {outline: none;}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4;}body h1 .octicon-link,body h2 .octicon-link,body h3 .octicon-link,body h4 .octicon-link,body h5 .octicon-link,body h6 .octicon-link {color: #000;vertical-align: middle;visibility: hidden;}body h1:hover .anchor,body h2:hover .anchor,body h3:hover .anchor,body h4:hover .anchor,body h5:hover .anchor,body h6:hover .anchor {text-decoration: none;}body h1:hover .anchor .octicon-link,body h2:hover .anchor .octicon-link,body h3:hover .anchor .octicon-link,body h4:hover .anchor .octicon-link,body h5:hover .anchor .octicon-link,body h6:hover .anchor .octicon-link {visibility: visible;}body h1 {padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.2;}body h1 .anchor {line-height: 1;}body h2 {padding-bottom: 0.3em;font-size: 1.5em;line-height: 1.225;}body h2 .anchor {line-height: 1;}body h3 {font-size: 1.25em;line-height: 1.43;}body h3 .anchor {line-height: 1.2;}body h4 {font-size: 1em;}body h4 .anchor {line-height: 1.2;}body h5 {font-size: 1em;}body h5 .anchor {line-height: 1.1;}body h6 {font-size: 1em;color: #777;}body h6 .anchor {line-height: 1.1;}body p,body blockquote,body ul,body ol,body dl,body table,body pre {margin-top: 0;margin-bottom: 16px;}body hr {height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;}body ul,body ol {padding-left: 2em;}body ul ul,body ul ol,body ol ol,body ol ul {margin-top: 0;margin-bottom: 0;}body li>p {margin-top: 16px;}body dl {padding: 0;}body dl dt {padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold;}body dl dd {padding: 0 16px;margin-bottom: 16px;}body blockquote {padding: 0 15px;color: #777;border-left: 4px solid #ddd;}body blockquote>:first-child {margin-top: 0;}body blockquote>:last-child {margin-bottom: 0;}body table {display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all;}body table th {font-weight: bold;}body table th,body table td {padding: 6px 13px;border: 1px solid #ddd;}body table tr {background-color: #fff;border-top: 1px solid #ccc;}body table tr:nth-child(2n) {background-color: #f8f8f8;}body img {max-width: 100%;box-sizing: content-box;background-color: #fff;}body code {padding: 0;padding-top: 0;padding-bottom: 0;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}body code:before,body code:after {letter-spacing: -0.2em;content: "\00a0";}body pre>code {padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0;}body .highlight {margin-bottom: 16px;}body .highlight pre,body pre {padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px;}body .highlight pre {margin-bottom: 0;word-break: normal;}body pre {word-wrap: normal;}body pre code {display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0;}body pre code:before,body pre code:after {content: normal;}body kbd {display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .pl-c {color: #969896;}body .pl-c1,body .pl-s .pl-v {color: #0086b3;}body .pl-e,body .pl-en {color: #795da3;}body .pl-s .pl-s1,body .pl-smi {color: #333;}body .pl-ent {color: #63a35c;}body .pl-k {color: #a71d5d;}body .pl-pds,body .pl-s,body .pl-s .pl-pse .pl-s1,body .pl-sr,body .pl-sr .pl-cce,body .pl-sr .pl-sra,body .pl-sr .pl-sre {color: #183691;}body .pl-v {color: #ed6a43;}body .pl-id {color: #b52a1d;}body .pl-ii {background-color: #b52a1d;color: #f8f8f8;}body .pl-sr .pl-cce {color: #63a35c;font-weight: bold;}body .pl-ml {color: #693a17;}body .pl-mh,body .pl-mh .pl-en,body .pl-ms {color: #1d3e81;font-weight: bold;}body .pl-mq {color: #008080;}body .pl-mi {color: #333;font-style: italic;}body .pl-mb {color: #333;font-weight: bold;}body .pl-md {background-color: #ffecec;color: #bd2c00;}body .pl-mi1 {background-color: #eaffea;color: #55a532;}body .pl-mdr {color: #795da3;font-weight: bold;}body .pl-mo {color: #1d3e81;}body kbd {display: inline-block;padding: 3px 5px;font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .task-list-item {list-style-type: none;}body .task-list-item+.task-list-item {margin-top: 3px;}body .task-list-item input {margin: 0 0.35em 0.25em -1.6em;vertical-align: middle;}body :checked+.radio-label {z-index: 1;position: relative;border-color: #4078c0;}</style>
  
    
  
</head>
<body>
<h1 id="cxpbutton-class">CXpButton Class</h1>
<p>Theme aware push button that can also act as a toggle button and display an icon or bitmap.</p>
<ul>
<li>Draws a themed button in Windows XP or superior, using the functions available in UxTheme.dll, or a button with classic appearance in other versions of Windows, using GDI functions.</li>
<li>Allows up to three images per button (for normal, hot and disabled states). If you want a button with a centered image and no text, use the XPBI_CENTERCENTER flag in the <strong>ImagePos</strong> method.</li>
<li>Can be used as a toggle button setting this flag with the <strong>Toggle</strong> method.</li>
<li>Images and fonts are owned and destroyed by the control.</li>
<li>If theming is diabled, you can use you own colors for the different elements of the button: Background, foreground, text, etc.</li>
</ul>
<h3 id="constructor">Constructor</h3>
<p>Registers the class name and creates an instance of the control.</p>
<pre><code>CONSTRUCTOR CXpButton (BYVAL pWindow AS CWindow PTR, BYVAL cID AS LONG_PTR, _
   BYREF wszTitle AS WSTRING = &quot;&quot;, BYVAL x AS LONG = 0, BYVAL y AS LONG = 0, _
   BYVAL nWidth AS LONG = 0, BYVAL nHeight AS LONG = 0, BYVAL dwStyle AS DWORD = 0, _
   BYVAL dwExStyle AS DWORD = 0, BYVAL lpParam AS LONG_PTR = 0)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>pWindow</em></td>
<td>Pointer to the <em>CWindow</em> class of the parent window.</td>
</tr>
<tr class="even">
<td><em>cID</em></td>
<td>Control identifier.</td>
</tr>
<tr class="odd">
<td><em>wszTitle</em></td>
<td>Optional. The button caption.</td>
</tr>
<tr class="even">
<td><em>x</em></td>
<td>Optional. The x-coordinate of the upper-left corner of the button relative to the upper-left corner of the parent window's client area.</td>
</tr>
<tr class="odd">
<td><em>y</em></td>
<td>Optional. The initial y-coordinate of the upper-left corner of the button relative to the upper-left corner of the parent window's client area.</td>
</tr>
<tr class="even">
<td><em>nWidth</em></td>
<td>Optional. The width of the button.</td>
</tr>
<tr class="odd">
<td><em>nHeight</em></td>
<td>Optional. The height of the button.</td>
</tr>
<tr class="even">
<td><em>dwStyle</em></td>
<td>Optional. The style of the button being created.&lt;&gt;Default styles: WS_VISIBLE OR WS_TABSTOP OR BS_PUSHBUTTON OR BS_CENTER OR BS_VCENTER.</td>
</tr>
<tr class="odd">
<td><em>dwExStyle</em></td>
<td>Optional. The extended window style of the button being created.</td>
</tr>
<tr class="even">
<td><em>lpParam</em></td>
<td>Optional. Pointer to custom data.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return value</h4>
<p>A pointer to the new instance of the class.</p>
<h3 id="helper-procedure:-afxcxpbuttonptr">Helper Procedure: AfxCXpButtonPtr</h3>
<p>Returns a pointer to the CXpButton class given the handle of its associated window.</p>
<pre><code>FUNCTION AfxCXpButtonPtr (BYVAL hwnd AS HWND) AS CXpButton PTR
FUNCTION AfxCXpButtonPtr (BYVAL hParent AS HWND, BYVAL cID AS LONG) AS CXpButton PTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hwnd</em></td>
<td>Handle of the window associated with the button control. Call the <strong>hWindow</strong> method of the <strong>CXpButton</strong> class to retrieve it.</td>
</tr>
<tr class="even">
<td><em>hParent</em></td>
<td>The handle of the parent window of the control.</td>
</tr>
<tr class="odd">
<td><em>cID</em></td>
<td>The identifier of the control.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-1">Return value</h4>
<p>A pointer to the CXpButton class.</p>
<h3 id="methods">Methods</h3>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#DisableTheming">DisableTheming</a></td>
<td>Disables theming.</td>
</tr>
<tr class="even">
<td><a href="#EnableTheming">EnableTheming</a></td>
<td>Enables theming.</td>
</tr>
<tr class="odd">
<td><a href="#GetImage">GetImage</a></td>
<td>Returns the handle of the image.</td>
</tr>
<tr class="even">
<td><a href="#hWindow">hWindow</a></td>
<td>Returns the handle of the button.</td>
</tr>
<tr class="odd">
<td><a href="#IsThemed">IsThemed</a></td>
<td>Returns CTRUE if themes are enabled or FALSE otherwise.</td>
</tr>
<tr class="even">
<td><a href="#Redraw">Redraw</a></td>
<td>Redraws the button.</td>
</tr>
<tr class="odd">
<td><a href="#SetBitmap">SetBitmap</a></td>
<td>Sets the bitmap for the button.</td>
</tr>
<tr class="even">
<td><a href="#SetBitmapFromFile">SetBitmapFromFile</a></td>
<td>Loads an bitmap from file and sets it as the image of tbe button.</td>
</tr>
<tr class="odd">
<td><a href="#SetIcon">SetIcon</a></td>
<td>Sets the icon for the button.</td>
</tr>
<tr class="even">
<td><a href="#SetIconFromFile">SetIconFromFile</a></td>
<td>Loads an icon from file and sets it as the image of tbe button.</td>
</tr>
<tr class="odd">
<td><a href="#SetImage">SetImage</a></td>
<td>Sets the image for the button.</td>
</tr>
<tr class="even">
<td><a href="#SetImageFromFile">SetImageFromFile</a></td>
<td>Loads an image from file and sets it as the image of the button.</td>
</tr>
<tr class="odd">
<td><a href="#SetImageFromRes">SetImageFromRes</a></td>
<td>Loads an image from a resource file and sets it as the image of the button.</td>
</tr>
</tbody>
</table>
<h3 id="properties">Properties</h3>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#BkBrush">BkBrush</a></td>
<td>Returns the background color brush.</td>
</tr>
<tr class="even">
<td><a href="#ButtonBkColor">ButtonBkColor</a></td>
<td>Gets/sets the background color of button.</td>
</tr>
<tr class="odd">
<td><a href="#ButtonBkColorDown">ButtonBkColorDown</a></td>
<td>Gets/sets the background color of button when it is down (pressed or toggled).</td>
</tr>
<tr class="even">
<td><a href="#ButtonBkColorHot">ButtonBkColorHot</a></td>
<td>Gets/sets the background color of button when it is hot (the mouse is over it).</td>
</tr>
<tr class="odd">
<td><a href="#ButtonState">ButtonState</a></td>
<td>Returns the button state.</td>
</tr>
<tr class="even">
<td><a href="#Cursor">Cursor</a></td>
<td>Gets/sets the cursor for the button.</td>
</tr>
<tr class="odd">
<td><a href="#DisabledImageHandle">DisabledImageHandle</a></td>
<td>Returns the handle of the disabled image.</td>
</tr>
<tr class="even">
<td><a href="#Font">Font</a></td>
<td>Gets/sets the handle of the font used by the button.</td>
</tr>
<tr class="odd">
<td><a href="#HotImageHandle">HotImageHandle</a></td>
<td>Returns the handle of the hot image.</td>
</tr>
<tr class="even">
<td><a href="#ImageHeight">ImageHeight</a></td>
<td>Gets/sets the heigth of the image.</td>
</tr>
<tr class="odd">
<td><a href="#ImageMargin">ImageMargin</a></td>
<td>Gets/sets the image margin.</td>
</tr>
<tr class="even">
<td><a href="#ImagePos">ImagePos</a></td>
<td>Gets/sets the image position.</td>
</tr>
<tr class="odd">
<td><a href="#ImageType">ImageType</a></td>
<td>Returns the image type</td>
</tr>
<tr class="even">
<td><a href="#ImageWidth">ImageWidth</a></td>
<td>Gets/sets the width of the image.</td>
</tr>
<tr class="odd">
<td><a href="#NormalImageHandle">NormalImageHandle</a></td>
<td>Returns the handle of the normal image.</td>
</tr>
<tr class="even">
<td><a href="#TextBkColor">TextBkColor</a></td>
<td>Gets/sets the text background color of the button.</td>
</tr>
<tr class="odd">
<td><a href="#TextBkColorDown">TextBkColorDown</a></td>
<td>Gets/sets the text background color of the button when it is down (pressed).</td>
</tr>
<tr class="even">
<td><a href="#TextForeColor">TextForeColor</a></td>
<td>Gets/sets the text foreground color of the button.</td>
</tr>
<tr class="odd">
<td><a href="#TextForeColorDown">TextForeColorDown</a></td>
<td>Gets/sets the text foreground color of the button when it is down (pressed).</td>
</tr>
<tr class="even">
<td><a href="#TextFormat">TextFormat</a></td>
<td>Gets/sets the method of formatting the text.</td>
</tr>
<tr class="odd">
<td><a href="#TextMargin">TextMargin</a></td>
<td>Gets/sets the margin of the text of the button.</td>
</tr>
<tr class="even">
<td><a href="#Toggle">Toggle</a></td>
<td>Gets/sets button to toggle state (CTRUE) or to pushbutton state (FALSE).</td>
</tr>
<tr class="odd">
<td><a href="#ToggleState">ToggleState</a></td>
<td>Gets/sets the toggle state: pushed (CTRUE) or unpushed (FALSE).</td>
</tr>
</tbody>
</table>
<h3 id="example">Example</h3>
<pre><code>#define UNICODE
#define _WIN32_WINNT &amp;h0602
#INCLUDE ONCE &quot;Afx/CWindow.inc&quot;
#INCLUDE ONCE &quot;Afx/CXpButton.inc&quot;
USING Afx

CONST IDC_BUTTON1 = 1001
CONST IDC_BUTTON2 = 1002
CONST IDC_BUTTON3 = 1003

DECLARE FUNCTION WinMain (BYVAL hInstance AS HINSTANCE, _
                          BYVAL hPrevInstance AS HINSTANCE, _
                          BYVAL szCmdLine AS ZSTRING PTR, _
                          BYVAL nCmdShow AS LONG) AS LONG

   END WinMain(GetModuleHandleW(NULL), NULL, COMMAND(), SW_NORMAL)

' // Forward declaration
DECLARE FUNCTION WndProc (BYVAL hwnd AS HWND, BYVAL uMsg AS UINT, BYVAL wParam AS WPARAM, BYVAL lParam AS LPARAM) AS LRESULT

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS HINSTANCE, _
                  BYVAL hPrevInstance AS HINSTANCE, _
                  BYVAL szCmdLine AS ZSTRING PTR, _
                  BYVAL nCmdShow AS LONG) AS LONG

   ' // Set process DPI aware
   AfxSetProcessDPIAware

   ' // Create the main window
   DIM pWindow AS CWindow
   pWindow.Create(NULL, &quot;XpButton example&quot;, @WndProc)
   pWindow.SetClientSize(215, 142)
   pWindow.Center

   ' // Create the first button
   DIM pXpButton1 AS CXpButton = CXpButton(@pWindow, IDC_BUTTON1, &quot;&amp;Hot&quot;, 50, 10, 114, 34)
   ' // Load a png icon from file (remember to change tha path of the file)
   pXpButton1.SetImageFromFile(ExePath &amp; &quot;/arrow_left_64.png&quot;, XPBI_NORMAL)
   ' // Load a Windows predefined icon as the &quot;hot&quot; image
   pXpButton1.SetIcon LoadIcon(NULL, IDI_QUESTION), XPBI_HOT
   ' // Change the cursor shape
   pXpButton1.SetCursor LoadCursor(NULL, IDC_CROSS)
   ' // Set a margin of 10 dpi units (pixels x scaling ratio)
   pXpButton1.SetImageMargin 10

   ' // Create the second button
   DIM pXpButton2 AS CXpButton = CXpButton(@pWindow, IDC_BUTTON2, &quot;&amp;Cancel&quot;, 50, 50, 114, 34)
   ' // Load a Windows predefined icon
   pXpButton2.SetIcon LoadIcon(NULL, IDI_ERROR), XPBI_NORMAL
   pXpButton2.SetImagePos XPBI_RIGHT OR XPBI_VCENTER
   pXpButton2.SetTextFormat DT_LEFT OR DT_VCENTER OR DT_SINGLELINE
'   EnableWindow pXpButton2.hWindow, FALSE   ' Disable the button

   ' // Create a coloured button
   DIM pXpButton3 AS CXpButton = CXpButton(@pWindow, IDC_BUTTON3, &quot;&amp;Coloured Button&quot;, 50, 90, 114, 34, WS_VISIBLE OR WS_TABSTOP OR BS_PUSHBUTTON OR BS_CENTER OR BS_VCENTER OR BS_FLAT)
   ' // Disable theming
   pXpButton3.DisableTheming
   ' // Set the background color to blue
   pXpButton3.SetButtonBkColor BGR(0, 0, 255)
   ' // Set the background color when pressed to yellow
   pXpButton3.SetButtonBkColorDown BGR(255, 255, 0)
   ' // Set the text foreground color to yellow
   pXpButton3.SetTextForeColor BGR(255, 255, 0)
   ' // Set the text background color to blue
   pXpButton3.SetTextBkColor BGR(0, 0, 255)
   ' // Set the text foreground color when pressed to white
   pXpButton3.SetTextForeColorDown BGR(255, 255, 255)
   ' // Set the text background color when pressed to red
   pXpButton3.SetTextBkColorDown BGR(255, 0, 0)
   ' // Set the text backround color when pressed to red
   pXpButton3.SetTextBkColorDown BGR(255, 0, 0)
   ' // Set the text format (cnetered and single line)
   pXpButton3.TextFormat = DT_CENTER OR DT_VCENTER OR DT_SINGLELINE
' pXpButton3.SetToggle TRUE   ' make it a toggle button

   ' // Set the focus in the first button
   SetFocus pXpButton1.hWindow

   ' // Dispatch Windows messages
   FUNCTION = pWindow.DoEvents(nCmdShow)

END FUNCTION
' ========================================================================================

' ========================================================================================
' Main window callback procedure
' ========================================================================================
FUNCTION WndProc (BYVAL hwnd AS HWND, BYVAL uMsg AS UINT, BYVAL wParam AS WPARAM, BYVAL lParam AS LPARAM) AS LRESULT

   SELECT CASE uMsg

      CASE WM_COMMAND
         SELECT CASE GET_WM_COMMAND_ID(wParam, lParam)
            CASE IDC_BUTTON1, IDC_BUTTON2, IDC_BUTTON3
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  ' AfxMsg &quot;Button clicked&quot;
                  EXIT FUNCTION
               END IF

            CASE IDCANCEL
               ' // If ESC key pressed, close the application by sending an WM_CLOSE message
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  SendMessageW hwnd, WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
         END SELECT

        CASE WM_DESTROY
         ' // Ends the application by sending a WM_QUIT message
         PostQuitMessage(0)
         EXIT FUNCTION

   END SELECT

   ' // Default processing of Windows messages
   FUNCTION = DefWindowProcW(hWnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================
</code></pre>
<h1 id="disabletheming"><a name="DisableTheming"></a>DisableTheming</h1>
<p>Disables theming.</p>
<pre><code>SUB DisableTheming
</code></pre>
<h1 id="enabletheming"><a name="EnableTheming"></a>EnableTheming</h1>
<p>Enables theming.</p>
<pre><code>SUB EnableTheming
</code></pre>
<h1 id="getimage"><a name="GetImage"></a>GetImage</h1>
<p>Returns the handle of the image.</p>
<pre><code>FUNCTION GetImage (BYVAL ImageState AS LONG) AS HANDLE
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
</tbody>
</table>
<h4 id="return-value-2">Return value</h4>
<p>Returns the handle of the requested image.</p>
<h1 id="hwindow"><a name="hWindow"></a>hWindow</h1>
<p>Returns the handle of the button.</p>
<pre><code>FUNCTION hWindow () AS HWND
</code></pre>
<h1 id="isthemed"><a name="IsThemed"></a>IsThemed</h1>
<p>Returns CTRUE if themes are enabled or FALSE otherwise.</p>
<pre><code>FUNCTION IsThemed () AS LONG
</code></pre>
<h1 id="redraw"><a name="Redraw"></a>Redraw</h1>
<p>Redraws the button.</p>
<pre><code>SUB Redraw
</code></pre>
<h1 id="setbitmap"><a name="SetBitmap"></a>SetBitmap</h1>
<p>Sets the bitmap for the button.</p>
<pre><code>SUB SetBitmap (BYVAL hBitmap AS HBITMAP, _
   BYVAL ImageState AS LONG, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hBitmap</em></td>
<td>Handle to the bitmap.</td>
</tr>
<tr class="even">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="setbitmapfromfile"><a name="SetBitmapFromFile"></a>SetBitmapFromFile</h1>
<p>Loads a bitmap from file and sets it as the image of tbe button.</p>
<pre><code>SUB SetBitmapFromFile (BYVAL pwszPath AS WSTRING PTR, _
   BYVAL ImageState AS LONG, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>pwszPath</em></td>
<td>Full path of the bitmap's file.</td>
</tr>
<tr class="even">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="seticon"><a name="SetIcon"></a>SetIcon</h1>
<p>Sets the icon for the button.</p>
<pre><code>SUB SetIcon (BYVAL hIcon AS HICON, _
   BYVAL ImageState AS LONG, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hIcon</em></td>
<td>Handle to the icon.</td>
</tr>
<tr class="even">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="seticonfromfile"><a name="SetIconFromFile"></a>SetIconFromFile</h1>
<p>Loads an icon from file and sets it as the image of tbe button.</p>
<pre><code>SUB SetIconFromFile (BYVAL pwszPath AS WSTRING PTR, _
   BYVAL ImageState AS LONG, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>pwszPath</em></td>
<td>Full path of the icon's file.</td>
</tr>
<tr class="even">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="setimage"><a name="SetImage"></a>SetImage</h1>
<p>Sets the image for the button.</p>
<pre><code>SUB SetImage (BYVAL hImage AS HANDLE, BYVAL ImageType AS LONG, _
   BYVAL ImageState AS LONG, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hImage</em></td>
<td>Handle to the image.</td>
</tr>
<tr class="even">
<td><em>ImageType</em></td>
<td>IMAGE_ICON or IMAGE_BITMAP.</td>
</tr>
<tr class="odd">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="setimagefromfile"><a name="SetImageFromFile"></a>SetImageFromFile</h1>
<p>Loads an image from file and sets it as the image of the button.</p>
<pre><code>SUB SetImageFromFile (BYREF wszPath AS WSTRING, BYVAL ImageState AS LONG, _
   BYVAL dimPercent AS LONG = 0, BYVAL bGrayScale AS LONG = FALSE, _
   BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszPath</em></td>
<td>Full path of the image's file.</td>
</tr>
<tr class="even">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="odd">
<td><em>dimPercent</em></td>
<td>Percent of dimming (1-99)</td>
</tr>
<tr class="even">
<td><em>bGrayScale</em></td>
<td>CTRUE or FALSE. Convert to gray scale.</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="setimagefromres"><a name="SetImageFromRes"></a>SetImageFromRes</h1>
<p>Loads an image from file and sets it as the image of the button.</p>
<pre><code>SUB SetImageFromRes (BYVAL hInstance AS HINSTANCE, BYREF wszImageName AS WSTRING, _
   BYVAL ImageState AS LONG, BYVAL dimPercent AS LONG = 0, _
   BYVAL bGrayScale AS LONG = FALSE, BYVAL fRedraw AS LONG = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hInstance</em></td>
<td>A handle to the module whose portable executable file or an accompanying MUI file contains the resource. If this parameter is NULL, the function searches the module used to create the current process.</td>
</tr>
<tr class="even">
<td><em>wszImageName</em></td>
<td>Name of the image in the resource file (.RES). If the image resource uses an integral identifier, wszImage should begin with a number symbol (#) followed by the identifier in an ASCII format, e.g., &quot;#998&quot;. Otherwise, use the text identifier name for the image. Only images embedded as raw data (type RCDATA) are valid. These must be icons in format .png, .jpg, .gif, .tiff.</td>
</tr>
<tr class="odd">
<td><em>ImageState</em></td>
<td>One of the following values:<br>XPBI_NORMAL = 1, XPBI_HOT = 2, XPBI_DISABLED = 3</td>
</tr>
<tr class="even">
<td><em>dimPercent</em></td>
<td>Percent of dimming (1-99)</td>
</tr>
<tr class="odd">
<td><em>bGrayScale</em></td>
<td>CTRUE or FALSE. Convert to gray scale.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. CTRUE or FALSE (redraws the button to reflect the changes).</td>
</tr>
</tbody>
</table>
<h1 id="bkbrush"><a name="BkBrush"></a>BkBrush</h1>
<p>Returns the background color brush.</p>
<pre><code>PROPERTY BkBrush () AS HBRUSH
</code></pre>
<h1 id="buttonbkcolor"><a name="ButtonBkColor"></a>ButtonBkColor</h1>
<p>Gets/sets the background color of button.</p>
<pre><code>PROPERTY ButtonBkColor () AS COLORREF
PROPERTY ButtonBkColor (BYVAL bkColor AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>bkColor</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-3">Return value</h4>
<p>The background color of the button as a COLORREF value.</p>
<h4 id="remarks">Remarks</h4>
<p>Only available if the button is not themed. Call <strong>DisableTheming</strong> to disable theming.</p>
<h1 id="buttonbkcolordown"><a name="ButtonBkColorDown"></a>ButtonBkColorDown</h1>
<p>Gets/sets the background color of button when it is down (pressed or toggled).</p>
<pre><code>PROPERTY ButtonBkColorDown () AS COLORREF
PROPERTY ButtonBkColorDown (BYVAL bkColorDown AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>bkColorDown</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-4">Return value</h4>
<p>The background color of button when it is down (pressed or toggled).</p>
<h4 id="remarks-1">Remarks</h4>
<p>Only available if the button is not themed. Call <strong>DisableTheming</strong> to disable theming.</p>
<h1 id="buttonbkcolorhot"><a name="ButtonBkColorHot"></a>ButtonBkColorHot</h1>
<p>Gets/sets the background color of button when it is hot (the mouse is over it).</p>
<pre><code>PROPERTY ButtonBkColorHot () AS COLORREF
PROPERTY ButtonBkColorHot (BYVAL bkColorHot AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>bkColorHot</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-5">Return value</h4>
<p>The background color of button when it is hot (the mouse is over it).</p>
<h4 id="remarks-2">Remarks</h4>
<p>Only available if the button is not themed. Call <strong>DisableTheming</strong> to disable theming.</p>
<h1 id="buttonstate"><a name="ButtonState"></a>ButtonState</h1>
<p>Returns the button state.</p>
<pre><code>PROPERTY ButtonState () AS LONG
</code></pre>
<h4 id="return-value-6">Return value</h4>
<p>The button state: Pushed (BST_PUSHED) or unpushed.</p>
<h1 id="cursor"><a name="Cursor"></a>Cursor</h1>
<p>Gets/sets the cursor for the button.</p>
<pre><code>PROPERTY Cursor () AS HCURSOR
PROPERTY Cursor (BYVAL hCursor AS HCURSOR)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hCursor</em></td>
<td>Handle to the cursor.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-7">Return value</h4>
<p>The cursor handle.</p>
<h1 id="normalimagehandle"><a name="NormalImageHandle"></a>NormalImageHandle</h1>
<p>Returns the handle of the normal image.</p>
<pre><code>PROPERTY NormalImageHandle () AS HANDLE
</code></pre>
<h1 id="disabledimagehandle"><a name="DisabledImageHandle"></a>DisabledImageHandle</h1>
<p>Returns the handle of the disabled image.</p>
<pre><code>PROPERTY DisabledImageHandle () AS HANDLE
</code></pre>
<h1 id="hotimagehandle"><a name="HotImageHandle"></a>HotImageHandle</h1>
<p>Returns the handle of the hot image.</p>
<pre><code>PROPERTY HotImageHandle () AS HANDLE
</code></pre>
<h1 id="font"><a name="Font"></a>Font</h1>
<p>Gets/sets the handle of the font used by the button.</p>
<pre><code>PROPERTY Font () AS HFONT
PROPERTY Font (BYVAL hFont AS HFONT)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hFont</em></td>
<td>Handle to the font.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-8">Return value</h4>
<p>The font handle.</p>
<h1 id="imageheight"><a name="ImageHeight"></a>ImageHeight</h1>
<p>Gets/sets the heigth of the image.</p>
<pre><code>PROPERTY ImageHeight () AS LONG
PROPERTY ImageHeight (BYVAL nHeight AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nHeight</em></td>
<td>Height of the image, in pixels.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-9">Return value</h4>
<p>The height of the image, in pixels.</p>
<h1 id="imagemargin"><a name="ImageMargin"></a>ImageMargin</h1>
<p>Gets/sets the image margin.</p>
<pre><code>PROPERTY ImageMargin () AS LONG
PROPERTY ImageMargin (BYVAL nMargin AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nMargin</em></td>
<td>Margin (in pixels).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-10">Return value</h4>
<p>The margin of the image, in pixels.</p>
<h1 id="imagepos"><a name="ImagePos"></a>ImagePos</h1>
<p>Gets/sets the image position.</p>
<pre><code>PROPERTY ImagePos () AS LONG
PROPERTY ImagePos (BYVAL nPos AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nPos</em></td>
<td>The position of the image. Can be one of the following values:</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>XPBI_NONE</td>
<td>No image.</td>
</tr>
<tr class="even">
<td>XPBI_LEFT</td>
<td>Left side (default).</td>
</tr>
<tr class="odd">
<td>XPBI_RIGHT</td>
<td>Right side.</td>
</tr>
<tr class="even">
<td>XPBI_CENTER</td>
<td>Center.</td>
</tr>
<tr class="odd">
<td>XPBI_VCENTER</td>
<td>Vertically centered.</td>
</tr>
<tr class="even">
<td>XPBI_TOP</td>
<td>Top.</td>
</tr>
<tr class="odd">
<td>XPBI_BOTTOM</td>
<td>Bottom.</td>
</tr>
<tr class="even">
<td>XPBI_ABOVE</td>
<td>Above the text.</td>
</tr>
<tr class="odd">
<td>XPBI_BELOW</td>
<td>Below the text.</td>
</tr>
<tr class="even">
<td>XPBI_CENTECENTER</td>
<td>Center-center (no text).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-11">Return value</h4>
<p>The position of th image.</p>
<h1 id="imagetype"><a name="ImageType"></a>ImageType</h1>
<p>Returns the image type</p>
<pre><code>PROPERTY ImageType () AS LONG
</code></pre>
<h4 id="return-value-12">Return value</h4>
<p>The image type: IMAGE_ICON or IMAGE_BITMAP.</p>
<h1 id="imagewidth"><a name="ImageWidth"></a>ImageWidth</h1>
<p>Gets/sets the width of the image.</p>
<pre><code>PROPERTY ImageWidth () AS LONG
PROPERTY ImageWidth (BYVAL nWidth AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nWidth</em></td>
<td>Margin (in pixels).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-13">Return value</h4>
<p>The width of the image, in pixels.</p>
<h1 id="textbkcolor"><a name="TextBkColor"></a>TextBkColor</h1>
<p>Gets/sets the text background color of the button.</p>
<pre><code>PROPERTY TextBkColor () AS COLORREF
PROPERTY TextBkColor (BYVAL textColor AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>textColor</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-14">Return value</h4>
<p>The text background color of the button as a COLORREF value.</p>
<h1 id="textbkcolordown"><a name="TextBkColorDown"></a>TextBkColorDown</h1>
<p>Gets/sets the text background color of the button when it is down (pressed).</p>
<pre><code>PROPERTY TextBkColorDown () AS COLORREF
PROPERTY TextBkColorDown (BYVAL textColor AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>textColor</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-15">Return value</h4>
<p>The text background color of the button when it is down (pressed) as a COLORREF value.</p>
<h1 id="textforecolor"><a name="TextForeColor"></a>TextForeColor</h1>
<p>Gets/sets the text foreground color of the button.</p>
<pre><code>PROPERTY TextForeColor () AS COLORREF
PROPERTY TextForeColor (BYVAL textColor AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>textColor</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-16">Return value</h4>
<p>The text foreground color of the button as a COLORREF value.</p>
<h1 id="textforecolordown"><a name="TextForeColorDown"></a>TextForeColorDown</h1>
<p>Gets/sets the text foreground color of the button when it is down (pressed).</p>
<pre><code>PROPERTY TextForeColorDown () AS COLORREF
PROPERTY TextForeColorDown (BYVAL textColor AS COLORREF)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>textColor</em></td>
<td>A COLORREF color value. Use the FreeBasic BGR function.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-17">Return value</h4>
<p>The text foreground color of the button when it is down (pressed) as a COLORREF value.</p>
<h1 id="textformat"><a name="TextFormat"></a>TextFormat</h1>
<p>Gets/sets the method of formatting the text.</p>
<pre><code>PROPERTY TextFormat () AS DWORD
PROPERTY TextFormat (BYVAL dwTextFlags AS DWORD)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>dwTextFlags</em></td>
<td>Specifies the method of formatting the text. This parameter can be one or more of the following values:</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DT_BOTTOM</td>
<td>Justifies the text to the bottom of the rectangle. This value is used only with the DT_SINGLELINE value.</td>
</tr>
<tr class="even">
<td>DT_CALCRECT</td>
<td>Determines the width and height of the rectangle. If there are multiple lines of text, DrawText uses the width of the rectangle pointed to by the lpRect parameter and extends the base of the rectangle to bound the last line of text. If the largest word is wider than the rectangle, the width is expanded. If the text is less than the width of the rectangle, the width is reduced. If there is only one line of text, DrawText modifies the right side of the rectangle so that it bounds the last character in the line. In either case, DrawText returns the height of the formatted text but does not draw the text.</td>
</tr>
<tr class="odd">
<td>DT_CENTER</td>
<td>Centers text horizontally in the rectangle.</td>
</tr>
<tr class="even">
<td>DT_EDITCONTROL</td>
<td>Duplicates the text-displaying characteristics of a multiline edit control. Specifically, the average character width is calculated in the same manner as for an edit control, and the function does not display a partially visible last line.</td>
</tr>
<tr class="odd">
<td>DT_END_ELLIPSIS</td>
<td>For displayed text, if the end of a string does not fit in the rectangle, it is truncated and ellipses are added. If a word that is not at the end of the string goes beyond the limits of the rectangle, it is truncated without ellipses. The string is not modified unless the DT_MODIFYSTRING flag is specified. Compare with DT_PATH_ELLIPSIS and DT_WORD_ELLIPSIS.</td>
</tr>
<tr class="even">
<td>DT_EXPANDTABS</td>
<td>Expands tab characters. The default number of characters per tab is eight. The DT_WORD_ELLIPSIS, DT_PATH_ELLIPSIS, and DT_END_ELLIPSIS values cannot be used with the DT_EXPANDTABS value.</td>
</tr>
<tr class="odd">
<td>DT_EXTERNALLEADING</td>
<td>Includes the font external leading in line height. Normally, external leading is not included in the height of a line of text.</td>
</tr>
<tr class="even">
<td>DT_HIDEPREFIX</td>
<td>Includes the font external leading in line height. Normally, external leading is not included in the height of a line of text.<br>Windows 2000/XP: Ignores the ampersand (&amp;) prefix character in the text. The letter that follows will not be underlined, but other mnemonic-prefix characters are still processed.<br>Example: input string: &quot;A&amp;bc&amp;&amp;d&quot;, normal: &quot;Abc&amp;d&quot;, DT_HIDEPREFIX: &quot;Abc&amp;d&quot;. Compare with DT_NOPREFIX and DT_PREFIXONLY.</td>
</tr>
<tr class="odd">
<td>DT_INTERNAL</td>
<td>Uses the system font to calculate text metrics.</td>
</tr>
<tr class="even">
<td>DT_LEFT</td>
<td>Aligns text to the left.</td>
</tr>
<tr class="odd">
<td>DT_MODIFYSTRING</td>
<td>Modifies the specified string to match the displayed text. This value has no effect unless DT_END_ELLIPSIS or DT_PATH_ELLIPSIS is specified.</td>
</tr>
<tr class="even">
<td>DT_NOCLIP</td>
<td>Draws without clipping. <strong>DrawText</strong> is somewhat faster when DT_NOCLIP is used.</td>
</tr>
<tr class="odd">
<td>DT_NOFULLWIDTHCHARBREAK</td>
<td>Windows 98/Me, Windows 2000/XP: Prevents a line break at a DBCS (double-wide character string), so that the line breaking rule is equivalent to SBCS strings. For example, this can be used in Korean windows, for more readability of icon labels. This value has no effect unless DT_WORDBREAK is specified.</td>
</tr>
<tr class="even">
<td>DT_NOPREFIX</td>
<td>Uses the system font to calculate text metrics.Turns off processing of prefix characters. Normally, DrawText interprets the mnemonic-prefix character &amp; as a directive to underscore the character that follows, and the mnemonic-prefix characters &amp;&amp; as a directive to print a single &amp;. By specifying DT_NOPREFIX, this processing is turned off.<br>Example: input string: &quot;A&amp;bc&amp;&amp;d&quot;, normal: &quot;Abc&amp;d&quot;, DT_NOPREFIX: &quot;A&amp;bc&amp;&amp;d&quot;. Compare with DT_HIDEPREFIX and DT_PREFIXONLY.</td>
</tr>
<tr class="odd">
<td>DT_PATH_ELLIPSIS</td>
<td>For displayed text, replaces characters in the middle of the string with ellipses so that the result fits in the specified rectangle. If the string contains backslash () characters, DT_PATH_ELLIPSIS preserves as much as possible of the text after the last backslash. The string is not modified unless the DT_MODIFYSTRING flag is specified. Compare with DT_END_ELLIPSIS and DT_WORD_ELLIPSIS.</td>
</tr>
<tr class="even">
<td>DT_PREFIXONLY</td>
<td>Windows 2000/XP: Draws only an underline at the position of the character following the ampersand (&amp;) prefix character. Does not draw any other characters in the string.<br>Example: input string: &quot;A&amp;bc&amp;&amp;d&quot;, normal: &quot;Abc&amp;d&quot;, DT_PREFIXONLY: &quot; _ &quot;. Compare with DT_HIDEPREFIX and DT_NOPREFIX.</td>
</tr>
<tr class="odd">
<td>DT_RIGHT</td>
<td>Aligns text to the right.</td>
</tr>
<tr class="even">
<td>DT_RTLREADING</td>
<td>Layout in right-to-left reading order for bi-directional text when the font selected into the hdc is a Hebrew or Arabic font. The default reading order for all text is left-to-right.</td>
</tr>
<tr class="odd">
<td>DT_SINGLELINE</td>
<td>Displays text on a single line only. Carriage returns and line feeds do not break the line.</td>
</tr>
<tr class="even">
<td>DT_TABSTOP</td>
<td>Sets tab stops. Bits 15-8 (high-order byte of the low-order word) of the uFormat parameter specify the number of characters for each tab. The default number of characters per tab is eight. The DT_CALCRECT, DT_EXTERNALLEADING, DT_INTERNAL, DT_NOCLIP, and DT_NOPREFIX values cannot be used with the DT_TABSTOP value.</td>
</tr>
<tr class="odd">
<td>DT_TOP</td>
<td>Justifies the text to the top of the rectangle.</td>
</tr>
<tr class="even">
<td>DT_VCENTER</td>
<td>Centers text vertically. This value is used only with the DT_SINGLELINE value.</td>
</tr>
<tr class="odd">
<td>DT_WORDBREAK</td>
<td>Breaks words. Lines are automatically broken between words if a word would extend past the edge of the rectangle specified by the lpRect parameter. A carriage return-line feed sequence also breaks the line. If this is not specified, output is on one line.</td>
</tr>
<tr class="even">
<td>DT_WORD_ELLIPSIS</td>
<td>Truncates any word that does not fit in the rectangle and adds ellipses. Compare with DT_END_ELLIPSIS and DT_PATH_ELLIPSIS.</td>
</tr>
</tbody>
</table>
<p><strong>Default value</strong>: DT_CENTER OR DT_VCENTER OR DT_SINGLELINE.</p>
<h4 id="return-value-18">Return value</h4>
<p>The method of formatting the text.</p>
<h1 id="textmargin"><a name="TextMargin"></a>TextMargin</h1>
<p>Gets/sets the the margin of the text of the button.</p>
<pre><code>PROPERTY TextMargin () AS LONG
PROPERTY TextMargin (BYVAL nMargin AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nMargin</em></td>
<td>Margin (in pixels).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-19">Return value</h4>
<p>The text margin.</p>
<h1 id="toggle"><a name="Toggle"></a>Toggle</h1>
<p>Gets/sets button to toggle state (TRUE) or to pushbutton state (FALSE).</p>
<pre><code>PROPERTY Toggle () AS LONG
PROPERTY Toggle (BYVAL fToggle AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>fToggle</em></td>
<td>Toggled state (CTRUE or FALSE).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-20">Return value</h4>
<p>Returns CTRUE if the button is toggled or FALSE otherwise.</p>
<h1 id="togglestate"><a name="ToggleState"></a>ToggleState</h1>
<p>Gets/sets the toggle state: pushed (CTRUE) or unpushed (FALSE).</p>
<pre><code>PROPERTY ToggleState () AS LONG
PROPERTY ToggleState (BYVAL fState AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>fState</em></td>
<td>Toggle state (TRUE or FALSE).</td>
</tr>
</tbody>
</table>
<h4 id="return-value-21">Return value</h4>
<p>Returns CTRUE if the button is toggled or FALSE otherwise.</p>
<h4 id="return-value-22">Return value</h4>
<p>Returns CTRUE if the button is toggled or FALSE otherwise.</p>
</body>
</html>

